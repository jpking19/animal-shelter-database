<html lang="en">
<head>
  <style src="css/style.css"></style>
  <title>CS4241 Assignment 2</title>
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="css/style.css" />
  <link rel="icon" href="https://image.flaticon.com/icons/svg/64/64431.svg">
  <script>
  // Update table on startup



  // Form submission
  window.addEventListener("DOMContentLoaded", function () {
    var form = document.getElementById("test").addEventListener("click", function (){
      //test send something to DB
      event.preventDefault();
      var dataForm = new FormData(document.getElementById("form_id"));
      var ConvertedJSON= {
        "Alcohol1": document.getElementById('alcohol_low').value,
        "Alcohol2": document.getElementById('alcohol_high').value,
        "brewer": document.getElementById('brewer').value,
        "categories": document.getElementById('categories').value,
        "style": document.getElementById('style').value,
        "country": document.getElementById('country').value,
      };
      xhr = new XMLHttpRequest();
      xhr.onreadystatechange = handle_res;
      xhr.open('POST', '/json-handler');
      xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
      xhr.send(JSON.stringify(ConvertedJSON));

      // Change cursor to wait
      document.body.style.cursor = "wait";

      function handle_res() {
        if(this.readyState != 4) return;
        if(this.status != 200) {
          //error
        }
        var beer = JSON.parse(this.responseText);
        var alc = JSON.stringify(beer.fields.abv);

        // Display the chosen beer
        document.getElementById("n1").innerHTML = beer.fields.name;
        document.getElementById("n2").innerHTML = alc.substring(0,4) + "%";

        document.getElementById("beer").style.display = "block";
        var elem = document.getElementById("beer");
        var pos = 500;

        }
      })
    })

  // Helper functions
  function checkAge() {
    var userDate = document.getElementById('day').value +"/"+ document.getElementById('month').value +"/"+  document.getElementById('year').value;

    var today = new Date();
    var birthDate = new Date(userDate);

    var age = today.getFullYear() - birthDate.getFullYear();
    var m = today.getMonth() - birthDate.getMonth();
    if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
        age--;
    }

    if (age < 21) {
      // Route to baby page
      window.location = "baby.html";
    } else {
      document.getElementById('popup-wrapper').style.display="none";
    }
  }
  </script>
</head>
<body>
  <p id="test">yooo</p>
</body>
</html>
